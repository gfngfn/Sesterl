module RecordTest = struct

  let get_foo(x) = x.foo

  let update_bar(x) = { x | bar = false }

  let add_foo_and_bar(x) =
    x.foo + (if x.bar then 1 else 0)

  let record() = { foo = 42, bar = true }

  let default(b, x) =
    if b then record() else x

  let main(args) =
    let r = record() in
    print_debug({
      original   = r,
      projection = get_foo(r),
      update     = update_bar(r),
      operation  = add_foo_and_bar(r),
    })

end
